<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>é…’åº—è¯„è®º</title>
  <style>
    :root{
      --bg:#f8f9fa;
      --card:#ffffff;
      --text:#212529;
      --sub:#6c757d;
      --brand:#9c6bff;
      --muted:#dee2e6;
      --accent:#28a745;
      --danger:#dc3545;
      --gutter: 16px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--text); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial}
    .app{max-width:520px; margin:0 auto; min-height:100%; display:flex; flex-direction:column}

    header{position:sticky; top:0; z-index:10; background:#fff; border-bottom:1px solid var(--muted)}
    .safe{padding: env(safe-area-inset-top) env(safe-area-inset-right) 0 env(safe-area-inset-left)}
    .head{display:flex; align-items:center; gap:12px; padding:14px calc(var(--gutter) + env(safe-area-inset-right)) 12px calc(var(--gutter) + env(safe-area-inset-left))}
    .logo{width:40px; height:40px; border-radius:12px; background:var(--brand); display:grid; place-items:center; color:#fff; font-weight:700}
    .title-wrap{flex:1}
    h1{margin:0; font-size:18px}
    .meta{font-size:12px; color:var(--sub); display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .star{color:#ffc107}

    .filter{display:flex; gap:8px; padding:8px calc(var(--gutter) + env(safe-area-inset-right)) 12px calc(var(--gutter) + env(safe-area-inset-left)); overflow:auto; scrollbar-width:none; scroll-padding-left: calc(var(--gutter) + env(safe-area-inset-left))}
    .chip{padding:8px 12px; font-size:12px; border:1px solid var(--muted); border-radius:999px; color:var(--sub); background:#f8f9fa; cursor:pointer; white-space:nowrap}
    .chip.active{border-color:var(--brand); color:var(--brand); background:#e9f5ff}

    main{padding:8px calc(var(--gutter) + env(safe-area-inset-right)) 24px calc(var(--gutter) + env(safe-area-inset-left))}

    .card{background:var(--card); border:1px solid var(--muted); border-radius:16px; padding:12px; margin:10px 0; box-shadow:0 2px 6px rgba(0,0,0,.05)}
    .row{display:flex; gap:12px}
    .avatar{width:40px; height:40px; border-radius:50%; background:#e9ecef; display:grid; place-items:center; color:#495057; font-weight:700}
    .who{flex:1}
    .who .name{font-size:14px; font-weight:600}
    .who .sub{font-size:12px; color:var(--sub)}
    .who .tags{margin-top:4px; display:flex; flex-wrap:wrap; gap:6px}
    .tag{font-size:10px; padding:4px 8px; border-radius:999px; border:1px solid var(--muted); color:#6c757d}

    .pill{display:inline-flex; align-items:center; gap:4px; padding:2px 8px; border-radius:999px; border:1px solid var(--muted); background:#f8f9fa; font-size:11px}

    /* â€”â€” æ–‡å­—è¯„è®ºå— â€”â€” */
    .text-review{margin-top:10px; border:1px solid var(--muted); border-radius:14px; background:#f8f9fa; padding:12px}
    .text-review .content{font-size:14px; line-height:1.6; color:var(--text); word-break:break-word; white-space:pre-wrap}
    .text-review .status{margin-top:6px; font-size:12px; color:var(--sub)}
    .text-review.empty{background:#fff; border-style:dashed}
    .text-review.empty .status{color:var(--danger)}

    /* å›¾ç‰‡åŒºåŸŸ */
    .photos{margin-top:10px}
    .grid{display:grid; grid-template-columns:repeat(3, 1fr); gap:6px}
    .thumb{width:100%; aspect-ratio:1/1; border-radius:10px; border:1px solid var(--muted); background:#f8f9fa; overflow:hidden; position:relative; cursor:pointer}
    .thumb img{width:100%; height:100%; object-fit:cover; display:block}

    /* å…¨å±å›¾ç‰‡æŸ¥çœ‹ */
    .viewer{position:fixed; inset:0; background:rgba(0,0,0,.75); display:none; align-items:center; justify-content:center; z-index:50}
    .viewer img{max-width:92vw; max-height:86vh; border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,.4)}
    .viewer.show{display:flex}

    footer{color:var(--sub); font-size:12px; text-align:center; padding:24px 8px 32px}
    .spacer{height: env(safe-area-inset-bottom)}
  </style>
</head>
<body>
  <div class="app">
    <header class="safe">
      <div class="head">
        <div class="logo" aria-hidden="true">ğŸ¨</div>
        <div class="title-wrap">
          <h1>T101é…’åº—</h1>
          <div class="meta">
            <span class="star">â˜… â˜… â˜… â˜… â˜†</span>
            <span>4.3 Â· 1,028 æ¡è¯„è®º</span>
            <span>Â·</span>
            <span class="pill">åœ°é“200m</span>
            <span class="pill">å…è´¹åœè½¦</span>
            <span class="pill">å…è´¹å–æ¶ˆ</span>
          </div>
        </div>
      </div>
      <div class="filter" role="tablist" aria-label="ç­›é€‰">
        <div class="chip active" role="tab" aria-selected="true" data-key="all">å…¨éƒ¨</div>
        <!-- å¯æŒ‰éœ€è¿½åŠ ï¼šå®¶åº­/å•†åŠ¡/äº¤é€š/å®‰é™/æ—©é¤/æ¸©æ³‰ -->
      </div>
    </header>

    <main id="list"></main>
  </div>

  <!-- å›¾ç‰‡æŸ¥çœ‹å™¨ -->
  <div class="viewer" id="viewer" aria-hidden="true">
    <img alt="é¢„è§ˆ" id="viewerImg" />
  </div>

  <template id="card-tpl">
    <article class="card" data-id="">
      <div class="row">
        <div class="avatar" aria-hidden="true">ğŸ‘¤</div>
        <div class="who">
          <div class="name">ä½å®¢</div>
          <div class="sub">
            <span class="date">2025-09-17</span>
            Â· <span class="stars">â˜…â˜…â˜…â˜…â˜…</span>
          </div>
          <div class="tags"></div>
        </div>
      </div>


      <!-- æ›¿æ¢ä¸ºã€æ–‡å­—è¯„è®ºå—ã€‘ -->
      <div class="text-review">
        <div class="content">æˆ¿é—´æ•´æ´ï¼ŒåºŠå¾ˆèˆ’æœï¼Œç©ºè°ƒå®‰é™ã€‚å‰å°åŠç†å…¥ä½å¾ˆå¿«ï¼Œç¦»åœ°é“å¾ˆè¿‘ï¼Œé€‚åˆçŸ­ä½ã€‚</div>
      </div>

      <!-- å›¾ç‰‡åŒºåŸŸï¼ˆè‹¥æ— å›¾ç‰‡å°†è‡ªåŠ¨éšè—ï¼‰ -->
      <div class="photos">
        <div class="grid"></div>
      </div>
    </article>
  </template>

  <script>
    // ================ æ•°æ®ï¼šå°† audioSrc æ›¿æ¢ä¸º text å­—æ®µ ================
    // tagKeys: family / business / transport / quiet / breakfast / onsen
    const reviews = [
      { id:1,  name:"ä½å®¢ A", date:"2025-09-17", stars:"â˜…â˜…â˜…â˜…â˜…", tags:[], tagKeys:["transport"], text:"è¿™ä¸ªé…’åº—è¶…ä¹æˆ‘çš„æƒ³è±¡ï¼Œæ€§ä»·æ¯”éå¸¸é«˜ï¼Œå¹²å‡€æ•´æ´ï¼Œç©ºé—´ä¹Ÿå®Œå…¨å¤Ÿç”¨ï¼Œå‰å°çš„å·¥ä½œäººå‘˜æ€åº¦éå¸¸äº²åˆ‡ã€‚", photos:["image/1-1.jpg","image/1-2.jpg","image/1-3.jpg"] },
      { id:2,  name:"ä½å®¢ B", date:"2025-09-10", stars:"â˜…â˜…â˜…â˜…â˜†", tags:[], tagKeys:["transport","breakfast"], text:"åŒåºŠæˆ¿è¿˜æ˜¯å¾ˆæœ‰æ€§ä»·æ¯”çš„ï¼Œå·¥ä½œäººå‘˜æœåŠ¡ä¹Ÿå¾ˆå¥½ï¼Œå”¯ä¸€ç¼ºç‚¹æ˜¯ç”µè§†æœ‰äº›æ¨¡ç³Šã€‚", photos:["image/2-1.jpg","image/2-2.jpg","image/2-3.jpg"] },
      { id:3,  name:"ä½å®¢ C", date:"2025-09-04", stars:"â˜…â˜…â˜…â˜†â˜†", tags:[], tagKeys:["quiet"], text:"å…¶ä»–çš„éƒ½å¾ˆå¥½ï¼Œå°±æ˜¯éš”éŸ³æœ‰ç‚¹ä¸€èˆ¬ã€‚ä½†æˆ¿é—´å«ç”Ÿå¾ˆå¥½å¾ˆå¹²å‡€å¾ˆæ–°ï¼ŒæœåŠ¡ä¹Ÿå¥½ã€‚", photos:["image/3-1.jpg","image/3-2.jpg","image/3-3.jpg"] },
      { id:4,  name:"ä½å®¢ D", date:"2025-08-19", stars:"â˜…â˜…â˜…â˜…â˜…", tags:[], tagKeys:["family"], text:"è¿™æ¬¡çš„å…¥ä½ä½“éªŒçœŸçš„éå¸¸æ»¡æ„ï¼Œé…’åº—çš„ç¯å¢ƒéå¸¸èˆ’é€‚ï¼Œæˆ¿é—´å®½æ•æ˜äº®ï¼ŒåºŠå“æŸ”è½¯å¹²å‡€ã€‚", photos:["image/4-1.jpg","image/4-2.jpg","image/4-3.jpg"] },
      { id:5,  name:"ä½å®¢ E", date:"2025-08-18", stars:"â˜…â˜†â˜†â˜†â˜†", tags:[], tagKeys:["business"], text:"æˆ‘åªèƒ½è¯´è¿™æ˜¯ä¸€æ¬¡éå¸¸éå¸¸ç³Ÿç³•çš„ä½“éªŒï¼Œä»å…¥ä½åˆ°é€€æˆ¿ã€‚å¤–è¡¨ä¸å†…åœ¨æœåŠ¡å®Œå…¨ä¸ç›¸ç¬¦ï¼Œå†·å†°å†°çš„åŠå…¥ä½ã€‚æˆ¿é—´åˆ°å¤„æ˜¯åšåšçš„ç°å°˜ï¼Œè¿˜æœ‰ä¸å°çš„å¼‚å‘³ã€‚", photos:["image/5-1.jpg","image/5-2.jpg","image/5-3.jpg"] },
      { id:6,  name:"ä½å®¢ F", date:"2025-08-18", stars:"â˜…â˜…â˜…â˜…â˜†", tags:[], tagKeys:[], text:"æˆ¿é—´æ”¶æ‹¾å¾—å¾ˆå¹²å‡€ï¼ŒåºŠå“æŸ”è½¯äº²è‚¤ï¼Œæ™šä¸Šç¡å¾—æ ¼å¤–å®‰ç¨³ï¼Œå‘¨è¾¹åƒé¥­è´­ç‰©ä¹Ÿæ–¹ä¾¿ã€‚", photos:["image/6-1.jpg","image/6-2.jpg","image/6-3.jpg"] },
      { id:7,  name:"ä½å®¢ G", date:"2025-08-08", stars:"â˜…â˜…â˜…â˜…â˜…", tags:[], tagKeys:[], text:"è¿™æ¬¡ä½“éªŒè¿œè¶…é¢„æœŸï¼Œé…’åº—è®¾æ–½å ªç§°æ»¡åˆ†ï¼Œæˆ¿é—´å®½æ•æ˜äº®ï¼ŒåºŠé“ºæŸ”è½¯èˆ’é€‚ã€‚æ›´æƒŠå–œçš„æ˜¯æœåŠ¡ï¼Œæ„Ÿå—åˆ°äº†å®¾è‡³å¦‚å½’çš„æ¸©æš–ã€‚", photos:["image/7-1.jpg","image/7-2.jpg"] },
      { id:8,  name:"ä½å®¢ H", date:"2025-08-03", stars:"â˜…â˜…â˜…â˜…â˜†", tags:[], tagKeys:["onsen"], text:"é…’åº—æ˜¯æ–°çš„ï¼Œå¤šå°‘æœ‰ç‚¹å‘³é“ï¼Œä½†æ˜¯é‡Œé¢çš„è£…ä¿®æ˜¯æˆ‘å–œæ¬¢çš„é£æ ¼ã€‚æˆ¿é—´è™½ç„¶æ²¡æœ‰å¾ˆå¤§ï¼Œä½†æ˜¯ç¡å¾—å¾ˆèˆ’æœã€‚", photos:["image/8-1.jpg","image/8-2.jpg"] },
      { id:9,  name:"ä½å®¢ I", date:"2025-08-02", stars:"â˜…â˜…â˜…â˜†â˜†", tags:[], tagKeys:["business"], text:"é…’åº—æ–°å¼€ä¸šï¼Œå«ç”ŸçŠ¶å†µè¾ƒæ»¡æ„ï¼Œåˆ°åœ°é“æ–¹ä¾¿ã€‚ä¸‹åˆå…¥ä½æ—¶æœ‰ç‚¹åµï¼Œå…¶ä»–è¿˜ç®—æ»¡æ„ã€‚", photos:["image/9-1.jpg","image/9-2.jpg","image/9-3.jpg"] },
      { id:10, name:"ä½å®¢ J", date:"2025-08-02", stars:"â˜…â˜…â˜…â˜…â˜…", tags:[], tagKeys:["quiet"], text:"é…’åº—ç´§æŒ¨åœ°é“ç«™å‡ºè¡Œéå¸¸æ–¹ä¾¿ï¼Œæˆ¿é—´å¥½ï¼ŒæœåŠ¡å¥½ï¼Œæ—©é¤ä¹Ÿä¸é”™ï¼Œå°¤å…¶æ˜¯é¦„é¥¨ä¸€æµã€‚", photos:["image/10-1.jpg","image/10-2.jpg"] }
    ];

    const $list = document.getElementById('list');
    const tpl = document.getElementById('card-tpl');
    const filterBar = document.querySelector('.filter');
    let curFilter = 'all';

    function createCard(data){
      const node = tpl.content.cloneNode(true);
      const card = node.querySelector('.card');
      card.dataset.id = data.id;
      card.dataset.tagKeys = (data.tagKeys||[]).join(',');
      card.querySelector('.name').textContent = data.name;
      card.querySelector('.date').textContent = data.date;
      card.querySelector('.stars').textContent = data.stars;

      const tagsWrap = card.querySelector('.tags');
      (data.tags||[]).forEach(t=>{ const span=document.createElement('span'); span.className='tag'; span.textContent=t; tagsWrap.appendChild(span); });

      // â€”â€” æ–‡å­—è¯„è®º â€”â€”
      const block = card.querySelector('.text-review');
      const contentEl = block.querySelector('.content');
      if (data.text && String(data.text).trim()) {
        contentEl.textContent = data.text;
      } else {
        block.classList.add('empty');
        contentEl.textContent = 'æš‚æ— æ–‡å­—è¯„è®º';
      }

      // â€”â€” å›¾ç‰‡ â€”â€”
      const photosWrap = card.querySelector('.photos');
      const grid = photosWrap.querySelector('.grid');
      if(Array.isArray(data.photos) && data.photos.length){
        data.photos.forEach((src,idx)=>{
          const box = document.createElement('div');
          box.className = 'thumb';
          const img = document.createElement('img');
          img.alt = `å›¾ç‰‡${idx+1}`; img.src = src;
          box.appendChild(img);
          box.addEventListener('click', ()=> openViewer(src));
          grid.appendChild(box);
        });
      } else {
        photosWrap.style.display = 'none';
      }

      return node;
    }

    function render(){
      $list.innerHTML = '';
      reviews.forEach(r=>{
        if(curFilter==='all' || (r.tagKeys||[]).includes(curFilter)){
          $list.appendChild(createCard(r));
        }
      });
    }

    // ç­›é€‰äº¤äº’ï¼ˆè‹¥éœ€è¦æ‰©å±•æ ‡ç­¾ï¼Œç…§æ—§æ·»åŠ  .chip data-key å³å¯ï¼‰
    filterBar.addEventListener('click', (e)=>{
      const item = e.target.closest('.chip');
      if(!item) return;
      document.querySelectorAll('.chip').forEach(ch=>ch.classList.remove('active'));
      item.classList.add('active');
      curFilter = item.dataset.key || 'all';
      render();
    });

    // å›¾ç‰‡æŸ¥çœ‹å™¨
    const viewer = document.getElementById('viewer');
    const viewerImg = document.getElementById('viewerImg');
    function openViewer(src){ viewerImg.src = src; viewer.classList.add('show'); viewer.setAttribute('aria-hidden','false'); }
    viewer.addEventListener('click', ()=>{ viewer.classList.remove('show'); viewer.setAttribute('aria-hidden','true'); viewerImg.removeAttribute('src'); });

    // åˆå§‹æ¸²æŸ“
    render();

    // ä½¿ç”¨è¯´æ˜ï¼š
    // 1ï¼‰å¤´éƒ¨ä¿¡æ¯å¯ç›´æ¥æ”¹ <header> ä¸­æ–‡æœ¬ï¼›
    // 2ï¼‰åœ¨ reviews[].text å†™å…¥è¯„è®ºå†…å®¹ï¼ˆä¸ºç©ºåˆ™å±•ç¤ºâ€œæš‚æ— æ–‡å­—è¯„è®ºâ€ï¼‰ï¼›
    // 3ï¼‰ä¿ç•™äº†ä¸è¯­éŸ³ç‰ˆä¸€è‡´çš„å¤–è§‚ã€ç­›é€‰ä¸å›¾ç‰‡æŸ¥çœ‹é€»è¾‘ï¼Œç§»åŠ¨ç«¯ä¼˜å…ˆã€‚
  </script>
</body>
</html>
